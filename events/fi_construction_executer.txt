namespace = fi_construction_executer

fi_construction_executer.1 = {
	type = country_event
	hidden = yes

	trigger = {
		has_variable = fi_identification
	}

	immediate = {
		set_variable = not_finished_construction
		set_variable = fi_cost_medium
		save_scope_as = fi_target_country
		while = {
			limit = {
				has_variable = not_finished_construction
			}
			count = 50

			fi_id_building_executor = {
				FUNCTION = execute_foreign_construction
			}
			
			if = {
				limit = {
					NOT = { has_variable = stop_ordering_construction }
				}
				fi_id_building_executor = {
					FUNCTION = order_foreign_construction
				}
			}

			remove_variable = stop_ordering_construction
		}

		if = {
			limit = {
				has_variable = not_finished_construction
			}
			remove_variable = not_finished_construction
		}
		if = {
			limit = {
				has_variable = number_of_foreign_construction
				var:number_of_foreign_construction <= 0
			}
			remove_variable = number_of_foreign_construction
		}
		remove_variable = fi_cost_medium
		trigger_event = { id = fi_construction_executer.10  days = 1}
	}
}

fi_construction_executer.2 = {
	type = country_event
	hidden = yes

	trigger = {
		has_variable = fi_identification
	}

	immediate = {
		set_variable = not_finished_construction
		set_variable = fi_cost_low
		save_scope_as = fi_target_country
		while = {
			limit = {
				has_variable = not_finished_construction
			}
			count = 50

			fi_id_building_executor = {
				FUNCTION = execute_foreign_construction
			}
			
			if = {
				limit = {
					NOT = { has_variable = stop_ordering_construction }
				}
				fi_id_building_executor = {
					FUNCTION = order_foreign_construction
				}
			}

			remove_variable = stop_ordering_construction
		}

		if = {
			limit = {
				has_variable = not_finished_construction
			}
			remove_variable = not_finished_construction
		}
		if = {
			limit = {
				has_variable = number_of_foreign_construction
				var:number_of_foreign_construction <= 0
			}
			remove_variable = number_of_foreign_construction
		}
		trigger_event = { id = fi_construction_executer.10  days = 1}
		
		remove_variable = fi_cost_low
	}
}

fi_construction_executer.3 = {
	type = country_event
	hidden = yes

	trigger = {
		has_variable = fi_identification
	}

	immediate = {
		set_variable = not_finished_construction
		set_variable = fi_cost_high
		save_scope_as = fi_target_country
		while = {
			limit = {
				has_variable = not_finished_construction
			}
			count = 50

			fi_id_building_executor = {
				FUNCTION = execute_foreign_construction
			}
			
			if = {
				limit = {
					NOT = { has_variable = stop_ordering_construction }
				}
				fi_id_building_executor = {
					FUNCTION = order_foreign_construction
				}
			}

			remove_variable = stop_ordering_construction
		}

		if = {
			limit = {
				has_variable = not_finished_construction
			}
			remove_variable = not_finished_construction
		}
		if = {
			limit = {
				has_variable = number_of_foreign_construction
				var:number_of_foreign_construction <= 0
			}
			remove_variable = number_of_foreign_construction
		}

		trigger_event = { id = fi_construction_executer.10  days = 1}
		remove_variable = fi_cost_high
	}
}

fi_construction_executer.4 = {
	type = country_event
	hidden = yes

	trigger = {
		has_variable = fi_identification
	}

	immediate = {
		set_variable = not_finished_construction
		set_variable = fi_cost_very_high
		save_scope_as = fi_target_country
		while = {
			limit = {
				has_variable = not_finished_construction
			}
			count = 50

			fi_id_building_executor = {
				FUNCTION = execute_foreign_construction
			}
			
			if = {
				limit = {
					NOT = { has_variable = stop_ordering_construction }
				}
				fi_id_building_executor = {
					FUNCTION = order_foreign_construction
				}
			}

			remove_variable = stop_ordering_construction
		}

		if = {
			limit = {
				has_variable = not_finished_construction
			}
			remove_variable = not_finished_construction
		}
		if = {
			limit = {
				has_variable = number_of_foreign_construction
				var:number_of_foreign_construction <= 0
			}
			remove_variable = number_of_foreign_construction
		}

		trigger_event = { id = fi_construction_executer.10  days = 1}
		remove_variable = fi_cost_very_high
	}
}


fi_construction_executer.10 = {
	type = country_event
	hidden = yes

	trigger = {
	}

	immediate = {
		every_scope_building = {
			limit = {
				is_building_type = building_investment_industry_low
				is_under_construction = no
			}
			state = { remove_building = building_investment_industry_low }
		}
		every_scope_building = {
			limit = {
				is_building_type = building_investment_industry_high
				is_under_construction = no
			}
			state = { remove_building = building_investment_industry_high }
		}
		every_scope_building = {
			limit = {
				is_building_type = building_investment_industry_very_high
				is_under_construction = no
			}
			state = { remove_building = building_investment_industry_very_high }
		}
	}
}


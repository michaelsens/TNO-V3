fi_construct_stock_exchange = {
	if = {
		limit = {
			20 > $BUILDING$_id
			$BUILDING$_id > 10
			owner = {
				NOT = {has_technology_researched = shaft_mining }
			}
		}
		set_variable = tech_target_state
		scope:investor_country = { trigger_event = { id = fi_share_taking_executer.7 } }
	}
	else_if = {
		limit = {
			$BUILDING$_id = 4
			owner = {
				NOT = {has_technology_researched = rubber_mastication }
			}
		}
		set_variable = tech_target_state
		scope:investor_country = { trigger_event = { id = fi_share_taking_executer.8 } }
	}
	else_if = {
		limit = {
			$BUILDING$_id = 5
			owner = {
				NOT = {has_technology_researched = pumpjacks }
			}
		}
		set_variable = tech_target_state
		scope:investor_country = { trigger_event = { id = fi_share_taking_executer.9 } }
	}
	else_if = {
		limit = {
			$BUILDING$_id = 6
			owner = {
				NOT = {has_technology_researched = railways }
			}
		}
		set_variable = tech_target_state
		scope:investor_country = { trigger_event = { id = fi_share_taking_executer.10 } }
	}
	else_if = {
		limit = {
			20 < $BUILDING$_id
			$BUILDING$_id < 30
			owner = {
				NOT = {has_technology_researched = enclosure }
			}
		}
		set_variable = tech_target_state
		scope:investor_country = { trigger_event = { id = fi_share_taking_executer.11 } }
	}
	else_if = {
		limit = {
			39 < $BUILDING$_id
			$BUILDING$_id < 46
			owner = {
				NOT = {has_technology_researched = manufacturies }
			}
		}
		set_variable = tech_target_state
		scope:investor_country = { trigger_event = { id = fi_share_taking_executer.13 } }
	}
    else_if = {
            limit = {
                    $BUILDING$_id = 46
                    owner = {
                            NOT = {has_technology_researched = intensive_agriculture }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.15 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 47
                    owner = {
                            NOT = {has_technology_researched = aniline }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.21 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 48
                    owner = {
                            NOT = {has_technology_researched = steelworking }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.23 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 49
                    owner = {
                            NOT = {has_technology_researched = atmospheric_engine }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.25 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 50
                    owner = {
                            NOT = {has_technology_researched = navigation }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.27 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 51
                    owner = {
                            NOT = {has_technology_researched = military_aviation }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.29 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 52
                    owner = {
                            NOT = {has_technology_researched = telephone }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.31 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 53
                    owner = {
                            NOT = {has_technology_researched = gunsmithing }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.33 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 54
                    owner = {
                            NOT = {has_technology_researched = percussion_cap }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.35 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 55
                    owner = {
                            NOT = {has_technology_researched = romanticism }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.37 } }
    }
    else_if = {
            limit = {
                    $BUILDING$_id = 56
                    owner = {
                            NOT = {has_technology_researched = electrical_generation }
                    }
            }
            set_variable = tech_target_state
            scope:investor_country = { trigger_event = { id = fi_share_taking_executer.39 } }
    }
    
    scope:investor_country = {
    	if = {
            limit = {
                NOT= { has_variable = fi_identification }
            }
            fi_assign_id = yes 
        }
		if = {
			limit = {
				$BUILDING$_cost_value = construction_cost_low
			}
			if = {
				limit = {
					OR = {
						has_law = law_type:law_command_economy
						NOT = { has_game_rule = autonomous_investment_pool }
					}
				} 
				market_capital = { start_building_construction = building_investment_industry_low }
			}
			else = {
				market_capital = { start_privately_funded_building_construction = building_investment_industry_low }
			}
		}
		else_if = {
			limit = {
				$BUILDING$_cost_value = construction_cost_medium
			}
			if = {
				limit = {
					OR = {
						has_law = law_type:law_command_economy
						NOT = { has_game_rule = autonomous_investment_pool }
					}
				} 
				market_capital = { start_building_construction = building_investment_industry }
			}
			else = {
				market_capital = { start_privately_funded_building_construction = building_investment_industry }
			}
		}
		else_if = {
			limit = {
				$BUILDING$_cost_value = construction_cost_very_high
			}
			if = {
				limit = {
					OR = {
						has_law = law_type:law_command_economy
						NOT = { has_game_rule = autonomous_investment_pool }
					}
				} 
				market_capital = { start_building_construction = building_investment_industry_very_high }
			}
			else = {
				market_capital = { start_privately_funded_building_construction = building_investment_industry_very_high }
			}
		}
		else = {
			if = {
				limit = {
					OR = {
						has_law = law_type:law_command_economy
						NOT = { has_game_rule = autonomous_investment_pool }
					}
				} 
				market_capital = { start_building_construction = building_investment_industry_high }
			}
			else = {
				market_capital = { start_privately_funded_building_construction = building_investment_industry_high }
			}
		}
	}
	fi_start_construction = { 
		BUILDING = $BUILDING$
	}
}